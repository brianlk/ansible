from flask import Flask, render_template, send_from_directory
from test.test1 import abc

app = Flask(__name__)

@app.route('/')
def index():
    return f'Hello World {abc()}'

@app.route('/ks/<os>')
def ks(os):
    abc="""
#version=RHEL8
ignoredisk --only-use=sda
autopart --type=lvm
# Partition clearing information
#clearpart --none --initlabel
zerombr
clearpart --all --initlabel
# Use graphical install
#graphical
text
# Use CDROM installation media
#cdrom
url --url https://download.rockylinux.org/pub/rocky/{os}/BaseOS/x86_64/os/
# Keyboard layouts
keyboard --vckeymap=us --xlayouts='us'
# System language
lang en_US.UTF-8

# Network information
network  --bootproto=static --device=ens32 --gateway=10.1.1.1 --ip=10.1.23.101 --nameserver=8.8.8.8 --netmask=255.255.0.0 --ipv6=auto --activate
network  --hostname=mytest.local
# Root password
sshkey --username=root "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC7zr5e/UqtSF+Uka6LveF9HBq0874SAIAWUmIcJBmfGcF4q7o7CTAMFwgY2NQxvEPe1FDTcSKYcwAQGndSj5CwZfqoEcFyjvPdYOVCW5jwkpE94qqZVoAJeXHZbJyAXDCPnfu+GRMwS3c3q+UcV1v/l6MlHFz/hJMIhSaPNZ5ZGLxBfvO0+1Y2dMVUvAkPIOzVts1kJDwTSh/ztf+nQ4PQzQxOwfh6AyahnBs80j9c+kOPlGOF1Sw+miSUqofHX+4KfkdXi8oah2W5N0pBWzCVkoLECo7xuz7AUP051LGKl+kRgmhpuckXXD/y95k8u8PD7HnGihGyfk08jHLusHeZewY4OGB2coKiLNreXQBljt+PX9b8XR1ppEnSFcOqH1JimKpTNC5AAFceIKkA449E50DKuVDkTy3xza1SFMtiYFICZiOALSpaAy4XU3rpHbyNHMcQk9qTRyjovh7CSRFiwws2ROV/grkEYWbr5421e8zRaAvAOA7FQoKNTnAsHy0= root@ctrl.example.com"
rootpw --iscrypted $6$jMMs4Nv.1BA8D74c$jHOC.koxhNO1VAIMbwm/QAd/iNSKwxKeetFgBDzPd42p2bcRknqD8O/0awUmnmBN2PMxyu3.eGF9WLsn3oSTx0
# Run the Setup Agent on first boot
firstboot --enable
# Do not configure the X Window System
skipx
# System services
services --enabled="chronyd"
# System timezone
timezone Asia/Hong_Kong --isUtc
reboot

%packages
@^minimal-environment
kexec-tools
curl
vim
git
telnet

%end

%addon com_redhat_kdump --enable --reserve-mb='auto'

%end

%anaconda
pwpolicy root --minlen=6 --minquality=1 --notstrict --nochanges --notempty
pwpolicy user --minlen=6 --minquality=1 --notstrict --nochanges --emptyok
pwpolicy luks --minlen=6 --minquality=1 --notstrict --nochanges --notempty
%end
    """
    return abc

@app.route('/static/<path:path>')
def home():
    return send_from_directory('static', path)

@app.errorhandler(500)
def internalServerError(error):
    err = "<p>ERROR! 500</p>"
    err += "<pre>"+ str(error) + "</pre>"
    err += "<pre>"+ str(traceback.format_exc()) + "</pre>"
    return err

if __name__ == '__main__':
    app.run()
